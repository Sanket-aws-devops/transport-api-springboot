version: 0.2

env:
  variables:
    DB_HOST: "10.0.132.61"
    DB_PORT: "3306"
    DB_NAME: "transport"
    DB_USER: "root"
    DB_PASSWORD: "root"

phases:
  pre_build:
    commands:
      - echo "Installing Java and Gradle"
      - apt-get update
      - apt-get install -y openjdk-11-jdk
      - java -version
      - wget https://services.gradle.org/distributions/gradle-7.2-bin.zip -P /tmp
      - unzip -d /opt/gradle /tmp/gradle-7.2-bin.zip
      - export PATH=$PATH:/opt/gradle/gradle-7.2/bin
      - gradle -version

  build:
    commands:
      - echo "Building Spring Boot application with Gradle"
      - gradle build

  post_build:
    commands:
      - echo "Build completed successfully"
      - echo "Running Spring Boot application"
      - ls
      - java -jar build/libs/transport-module-1.0.jar

artifacts:
  files:
    - build/libs/*.jar
